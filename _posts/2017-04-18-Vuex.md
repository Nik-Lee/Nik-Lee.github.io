---
layout: post
title: '理解Vuex 原理, 实践与实现'
date: 2017-04-18
categories: 技术
tags: Vue Vuex Flux
---

> 写在之前 小型应用 业务复杂度低 纯渲染页面的应用 不需要使用Vuex

## 1.什么是Vuex?
Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，
并以相应的规则保证状态以一种可预测的方式发生变化。Vuex 也集成到 Vue 的官方调试工具 devtools
extension，提供了诸如零配置的 time-travel 调试、状态快照导入导出等高级调试功能。

### 说人话～
用限制性的约束对所有组件的业务行为进行集中管理 也就是给组件们安排一个管理员, 管理员来限制组件的行为


## 2.为什么要用Vuex?
当一个项目/产品的组件之间的业务逻辑有很多关联时, 组件之间有可能会使用共同的数据(或者说状态State).
> 比如一个很多屏的电商H5, 每一屏都是一个独立的组件都有很多商品并且可以添加到购物车.
> 页面底部／头部还有一个购物车的overview, 比如显示一个count这样 另外还要存储cart items

#### 这么多组件都要用到count和cart item list这两个数据：
* 添加新商品要更新count 和 cart item list
* 移除商品或改变商品数量时也要更新 count 和 cart item list
* 添加完商品后 每个组件都有自己商品的数量controlbar. UI与未添加时不同
* 以及更复杂的组件件业务...

### 2.1 问题来了 -
这个时候给每个组件单独写事件会造成一个代码复杂度的迅速提升了n倍, 维护一个逻辑需要同时维护n个地方的代码.

* 代码维护费劲程度直线上升..

思考: 这时候我们有 **事件托管** 的经验: 我们可以把**父组件A**的添加商品数量事件层层传递给**商品组件（B,C,D...）** 然后**绑定到添加／减少**的事件上

> 题外话, 这个也是react组件间通信的好实践

这时候业务需求得到了一定满足, 两层嵌套的组件**共享状态**的问题好像解决了

### 2.2 问题又来了

这时候组件Z和组件Y也想掺和一下, 并且出现了4,5级的组件嵌套, 导致这个处理事件的方法在各个组件间层层传递（props）

整个项目的代码变得耦合性非常高, 终于成为了**意大利面** （...然而不能吃 你说气人不气人）

为了解决这个问题. 我们想要引入一个集中控制的地方去处理这样的业务复杂度, 以保证我们的组件是**干干净净**的

### 2.3 一些没有展开讨论的问题

* 不用vuex时, 子组件又要跟服务器通信又要通知父组件的时候就会又有很多新问题产生, 比如要执行很久等等
* 不用vuex时, 业务代码包括**业务代码和关联性后续业务操作代码**分散在各个组件, 维护起来需要查找很多地方, 并且需要一一维护


## 3 什么时候不用Vuex？
反着看第二段就成了～

## 4 实现原理
``
待完成...
``

## 5 实践
``
待完成...
``